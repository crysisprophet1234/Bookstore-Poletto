"use strict";(self.webpackChunkbookstore=self.webpackChunkbookstore||[]).push([[736],{6736:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var n=a(7689),i=a(9439),l=a(2791),r=a(5069),o=a(2512),s=a(1413),d=a(4695),u=a(1134),c=a(719),v=a(8622),f=a(9085),m=a(6727),b=a(2406),h=a(184),g=function(e){var t,a,n,o,g,p=e.onSubmitFilter,x=new Date((new Date).getTime()-15552e6).toISOString().substring(0,10),D=new Date((new Date).getTime()+2592e6).toISOString().substring(0,10),j=(0,l.useState)({initialDate:x,devolutionDate:D}),Z=(0,i.Z)(j,2),k=Z[0],N=Z[1],I=m.Ry().shape({id:m.Z_().matches(/^(?:[1-9][0-9]*)?$/,"C\xf3digo deve ser maior que 0"),clientId:m.Z_().matches(/^(?:[1-9][0-9]*)?$/,"C\xf3digo deve ser maior que 0"),bookId:m.Z_().matches(/^(?:[1-9][0-9]*)?$/,"C\xf3digo deve ser maior que 0"),startingDate:m.hT().max(new Date,"Data inicial n\xe3o pode ser maior que hoje"),devolutionDate:m.hT().min(k.initialDate,"Data final deve ser maior que inicial")}),S={resolver:(0,d.X)(I)},C=(0,u.cI)(S),y=C.register,w=C.handleSubmit,O=C.setValue,P=C.getValues,T=C.control,V=C.formState.errors,E=(0,l.useState)(""),F=(0,i.Z)(E,2),q=F[0],L=F[1],B=(0,l.useState)(""),Q=(0,i.Z)(B,2),R=Q[0],A=Q[1],M=(0,l.useState)(!1),_=(0,i.Z)(M,2),z=_[0],G=_[1];return(0,l.useEffect)((function(){if(P("clientId")){var e={method:"GET",url:"/api/users/v2/".concat(P("clientId")),withCredentials:!0};(0,r.QK)(e).then((function(e){L(e.data.firstname+" "+e.data.lastname)})).catch((function(e){L(""),f.Am.error(e.response.data.message)}))}}),[q,P]),(0,l.useEffect)((function(){if(P("bookId")){var e={method:"GET",url:"/api/books/v2/".concat(P("bookId")),withCredentials:!0};(0,r.QK)(e).then((function(e){A(e.data.name+", "+e.data.author.name)})).catch((function(e){A(""),f.Am.error(e.response.data.message)}))}}),[R,P]),(0,h.jsxs)("div",{className:"base-card p-3 mb-2 filter-container",children:[(0,h.jsxs)("div",{className:"filter-btn-container",children:[(0,h.jsx)(u.Qr,{name:"orderBy",control:T,defaultValue:"",render:function(e){var t=e.field;return(0,h.jsx)(v.ZP,(0,s.Z)((0,s.Z)({},t),{},{isMulti:!1,options:[{label:"Ordernar por",value:""},{label:"C\xf3digo",value:"id"},{label:"Data de cria\xe7\xe3o",value:"startingDate"},{label:"Status",value:"status"}],className:"select-order filter-right-btn",onChange:function(e){return O("orderBy",null===e||void 0===e?void 0:e.value)},value:void 0,defaultValue:{label:"Ordernar por",value:""},getOptionLabel:function(e){return String(null===e||void 0===e?void 0:e.label)},getOptionValue:function(e){return String(null===e||void 0===e?void 0:e.value)},form:"reservations-filter-form",styles:b.X}))}}),(0,h.jsx)(u.Qr,{name:"sort",control:T,defaultValue:"",render:function(e){var t=e.field;return(0,h.jsx)(v.ZP,(0,s.Z)((0,s.Z)({},t),{},{isMulti:!1,options:[{label:"Ordem",value:""},{label:"Crescente",value:"asc"},{label:"Decrescente",value:"desc"}],className:"select-order filter-right-btn",onChange:function(e){return O("sort",null===e||void 0===e?void 0:e.value)},value:void 0,defaultValue:{label:"Ordem",value:""},getOptionLabel:function(e){return String(null===e||void 0===e?void 0:e.label)},getOptionValue:function(e){return String(null===e||void 0===e?void 0:e.value)},form:"reservations-filter-form",styles:b.X}))}}),(0,h.jsx)("button",{className:"btn btn-outline-primary filter-right-btn",name:"expand-filter-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#full-filter","aria-expanded":"false","aria-controls":"full-filter","aria-label":"expand-filter-button",onClick:function(){G(!z)},children:window.innerWidth<768?(0,h.jsx)(c.G_S,{}):"Expandir filtros"})]}),(0,h.jsxs)("div",{className:"mb-3 double-input-container",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"id",children:"C\xf3digo"}),(0,h.jsx)("input",(0,s.Z)((0,s.Z)({},y("id",{required:!1})),{},{type:"number",className:"form-control base-input ".concat(V.id?"is-invalid":""),placeholder:"C\xf3digo da reserva",form:"reservations-filter-form",id:"id",name:"id"})),(0,h.jsx)("div",{className:"invalid-feedback d-block",children:null===(t=V.id)||void 0===t?void 0:t.message})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"status",children:"Status"}),(0,h.jsx)(u.Qr,{name:"status",control:T,defaultValue:"all",render:function(e){var t=e.field;return(0,h.jsx)(v.ZP,(0,s.Z)((0,s.Z)({},t),{},{isMulti:!1,options:[{label:"Todos",value:"all"},{label:"Em andamento",value:"in_progress"},{label:"Finalizadas",value:"finished"}],className:"filter-select",classNamePrefix:"filter-select",onChange:function(e){return O("status",null===e||void 0===e?void 0:e.value)},value:void 0,defaultValue:{label:"Todos",value:"all"},getOptionLabel:function(e){return String(null===e||void 0===e?void 0:e.label)},getOptionValue:function(e){return String(null===e||void 0===e?void 0:e.value)},form:"reservations-filter-form",name:"status",id:"status",styles:{control:function(e){return(0,s.Z)((0,s.Z)({},e),{},{height:"45px",minWidth:"200px"})},valueContainer:function(e){return(0,s.Z)((0,s.Z)({},e),{},{height:"45px",padding:"0px 8px"})},singleValue:function(e){return(0,s.Z)((0,s.Z)({},e),{},{lineHeight:"20px"})},input:function(e){return(0,s.Z)((0,s.Z)({},e),{},{margin:"0px"})},indicatorsContainer:function(e){return(0,s.Z)((0,s.Z)({},e),{},{height:"45px"})}}}))}})]})]}),(0,h.jsx)("div",{className:"collapse",id:"full-filter",children:(0,h.jsxs)("form",{id:"reservations-filter-form",onSubmit:w((function(e){p(e)})),children:[(0,h.jsxs)("div",{className:"mb-3 double-container",children:[(0,h.jsx)("label",{htmlFor:"clientId",children:"Cliente"}),(0,h.jsxs)("div",{className:"input-container",children:[(0,h.jsx)("input",(0,s.Z)((0,s.Z)({},y("clientId",{required:!1})),{},{type:"number",className:"form-control base-input ".concat(V.clientId?"is-invalid":""),placeholder:"C\xf3digo do cliente",onBlur:function(e){""!==e.target.value&&L("Loading...")},name:"clientId",id:"clientId"})),(0,h.jsx)("div",{className:"entity-name",children:q})]}),(0,h.jsx)("div",{className:"invalid-feedback d-block",children:null===(a=V.clientId)||void 0===a?void 0:a.message})]}),(0,h.jsxs)("div",{className:"mb-3 double-input-container",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"startingDate",children:"Data de \xednicio"}),(0,h.jsx)("input",(0,s.Z)((0,s.Z)({},y("startingDate",{required:!1})),{},{type:"date",className:"form-control base-input ".concat(V.startingDate?"is-invalid":""),name:"startingDate",id:"startingDate",value:k.initialDate,onChange:function(e){return N((0,s.Z)((0,s.Z)({},k),{},{initialDate:e.target.value}))}})),(0,h.jsx)("div",{className:"invalid-feedback d-block",children:null===(n=V.startingDate)||void 0===n?void 0:n.message})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"devolutionDate",children:"Data de devolu\xe7\xe3o"}),(0,h.jsx)("input",(0,s.Z)((0,s.Z)({},y("devolutionDate",{required:!1})),{},{type:"date",className:"form-control base-input ".concat(V.devolutionDate?"is-invalid":""),name:"devolutionDate",id:"devolutionDate",value:k.devolutionDate,onChange:function(e){return N((0,s.Z)((0,s.Z)({},k),{},{devolutionDate:e.target.value}))}})),(0,h.jsx)("div",{className:"invalid-feedback d-block",children:null===(o=V.devolutionDate)||void 0===o?void 0:o.message})]})]}),(0,h.jsxs)("div",{className:"mb-3 double-container",children:[(0,h.jsx)("label",{htmlFor:"bookId",children:"Livro"}),(0,h.jsxs)("div",{className:"input-container",children:[(0,h.jsx)("input",(0,s.Z)((0,s.Z)({},y("bookId",{required:!1})),{},{type:"number",className:"form-control base-input ".concat(V.bookId?"is-invalid":""),placeholder:"C\xf3digo do livro",onBlur:function(e){""!==e.target.value&&A("Loading...")},name:"bookId",id:"bookId"})),(0,h.jsx)("div",{className:"entity-name",children:R})]}),(0,h.jsx)("div",{className:"invalid-feedback d-block",children:null===(g=V.bookId)||void 0===g?void 0:g.message})]})]})}),(0,h.jsxs)("div",{className:"buttons-container",children:[(0,h.jsx)("button",{onClick:function(){N({initialDate:x,devolutionDate:D}),O("id",""),O("clientId",""),O("startingDate",new Date(x)),O("devolutionDate",new Date(D)),O("bookId",""),O("status","all"),L(""),A("")},type:"button",className:"btn btn-outline-dark btn-product-filter",children:"LIMPAR FILTRO"}),(0,h.jsx)("button",{type:"submit",className:"btn btn-outline-primary btn-product-filter mx-4",form:"reservations-filter-form",children:"PESQUISAR"})]})]})},p=a(4982),x=a(5052),D=(0,l.lazy)((function(){return a.e(843).then(a.bind(a,5843))})),j=function(){var e=(0,l.useState)(),t=(0,i.Z)(e,2),a=t[0],n=t[1],s=(0,l.useState)({activePage:0,filterData:{id:"",startingDate:new Date((new Date).getTime()-15552e6),devolutionDate:new Date((new Date).getTime()+2592e6),clientId:"",bookId:"",status:"all",orderBy:"id",sort:"asc"}}),d=(0,i.Z)(s,2),u=d[0],c=d[1],v=(0,l.useCallback)((function(){var e=u.filterData.id,t=""!==e?"/".concat(e):"",a={method:"GET",url:"/api/reservations/v2".concat(t),withCredentials:!0,params:{page:u.activePage,size:5,client:u.filterData.clientId,book:u.filterData.bookId,startingDate:(0,p.Hg)(u.filterData.startingDate),devolutionDate:(0,p.Hg)(u.filterData.devolutionDate),status:u.filterData.status,orderBy:u.filterData.orderBy,sort:u.filterData.sort}};(0,r.QK)(a).then((function(t){n(""!==e?{content:[t.data],totalPages:1,totalElements:1}:t.data)})).catch((function(e){console.log(e)}))}),[u]);return(0,l.useEffect)((function(){v()}),[v]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g,{onSubmitFilter:function(e){c({activePage:0,filterData:e})}}),(0,h.jsx)("div",{className:"mt-3",children:(0,h.jsx)(o.Z,{forcePage:null===a||void 0===a?void 0:a.number,pageCount:a?a.totalPages>0?a.totalPages:1:0,range:1,onChange:function(e){c({activePage:e,filterData:u.filterData})}})}),(0,h.jsx)("div",{className:"reservation-cards-container",children:null===a||void 0===a?void 0:a.content.map((function(e){return(0,h.jsx)(l.Suspense,{fallback:(0,h.jsx)("div",{className:"base-card loader",children:(0,h.jsx)(x.Z,{speedMultiplier:.65,color:"#0044E0",size:20,margin:15})}),children:(0,h.jsx)(D,{reservation:e,reservationReload:v})},e.id)}))})]})},Z=function(){return(0,h.jsxs)("div",{className:"container-fluid",children:[(0,h.jsx)("h2",{className:"mb-3",children:"Reservas"}),(0,h.jsx)(n.Z5,{children:(0,h.jsx)(n.AW,{path:"/",element:(0,h.jsx)(j,{})})})]})}},4982:function(e,t,a){a.d(t,{Hg:function(){return i},p6:function(){return n}});var n=function(e){var t=null===e||void 0===e?void 0:e.split(" ")[0],a=null===t||void 0===t?void 0:t.split("-");return a?"".concat(a[2],"/").concat(a[1],"/").concat(a[0]):null},i=function(e){try{return e.toISOString().split("T")[0]}catch(t){console.log(t)}}}}]);
//# sourceMappingURL=736.fca0ec81.chunk.js.map